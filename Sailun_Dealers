SELECT 
	CODE,
	NAME,
	c.REPORT,
	c.POLICY,
	c.REP,
	CASE 
		WHEN c.REP = 'KW' THEN 'WEST'
		WHEN c.REP = 'KS' THEN 'SOUTH'
		WHEN c.REP = 'KN' THEN 'NORTH'
		WHEN c.REP = 'KE' THEN 'EAST' 
		WHEN c.REP = 'KC' THEN 'CENTRAL'
		ELSE c.REP
	END AS Region,
	ADDR1,
	ADDR2,
	ADDR3,
	ADDR4,
	POSTCODE,
	CASE	
		WHEN LEFT(POSTCODE, 2) IN ('GY', 'IM') THEN ''
		ELSE c.COUNTRY
	END AS COUNTRY2,
	c.COUNTRY,
	PHONENUM,
	CREDLMT,
	--SELL_VAL2 AS Sales_Value_Current_FY,
	CRTNDATE
FROM CUSTOMER c
LEFT JOIN MONTLIST m ON c.CODE = m.CUSTOMER
WHERE 
	(
		CODE NOT LIKE 'SOR%'
		AND c.REP NOT IN ('SI', 'EX', '0')
		AND c.REP NOT LIKE 'W%'
		AND POSTCODE IS NOT NULL
		AND c.COUNTRY = 'UK'
		--AND TRLIST2 IN (8,9,11)
	)
	OR
	(
		CODE NOT LIKE 'SOR%'
		AND c.REP NOT IN ('SI', 'EX', '0')
		AND c.REP NOT LIKE 'W%'
		AND POSTCODE IS NOT NULL
		AND c.COUNTRY = 'UK'
		--AND TRLIST3 IN (8,9,11)
	)
ORDER BY 
	c.REPORT,
	c.REP
